Assumptions:

Only 'deposit' transactions can be disputed;
If any transaction fails the whole process should terminate, there's no partial success;
There's no duplicate dispute/resolve/chargeback transactions;
Dispute/resolve/chargeback transactions are consistent if they refer to existing transaction;